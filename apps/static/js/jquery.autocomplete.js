(function(b){if(typeof define==="function"&&define.amd){define(["jquery"],b)}else{if(typeof exports==="object"&&typeof require==="function"){b(require("jquery"))}else{b(jQuery)}}}(function(g){var f=(function(){return{escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},createNode:function(b){var a=document.createElement("div");a.className=b;a.style.position="absolute";a.style.display="none";return a}}}()),h={ESC:27,TAB:9,RETURN:13,LEFT:37,UP:38,RIGHT:39,DOWN:40};function e(b,c){var j=function(){},a=this,d={ajaxSettings:{},autoSelectFirst:false,appendTo:document.body,serviceUrl:null,lookup:null,onSelect:null,width:"auto",minChars:1,maxHeight:300,deferRequestBy:0,params:{},formatResult:e.formatResult,delimiter:null,zIndex:9999,type:"GET",noCache:false,onSearchStart:j,onSearchComplete:j,onSearchError:j,preserveInput:false,containerClass:"autocomplete-suggestions",tabDisabled:false,dataType:"text",currentRequest:null,triggerSelectOnValidInput:true,preventBadQueries:true,lookupFilter:function(i,m,n){return i.value.toLowerCase().indexOf(n)!==-1},paramName:"query",transformResult:function(i){return typeof i==="string"?g.parseJSON(i):i},showNoSuggestionNotice:false,noSuggestionNotice:"No results",orientation:"bottom",forceFixPosition:false};a.element=b;a.el=g(b);a.suggestions=[];a.badQueries=[];a.selectedIndex=-1;a.currentValue=a.element.value;a.intervalId=0;a.cachedResponse={};a.onChangeInterval=null;a.onChange=null;a.isLocal=false;a.suggestionsContainer=null;a.noSuggestionsContainer=null;a.options=g.extend({},d,c);a.classes={selected:"autocomplete-selected",suggestion:"autocomplete-suggestion"};a.hint=null;a.hintValue="";a.selection=null;a.initialize();a.setOptions(c)}e.utils=f;g.Autocomplete=e;e.formatResult=function(d,c){var a=d.value.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");var b="("+f.escapeRegExChars(c)+")";return a.replace(new RegExp(b,"gi"),"<strong>$1</strong>")};e.prototype={killerFn:null,initialize:function(){var j=this,d="."+j.classes.suggestion,a=j.classes.selected,b=j.options,c;j.element.setAttribute("autocomplete","off");j.killerFn=function(i){if(g(i.target).closest("."+j.options.containerClass).length===0){j.killSuggestions();j.disableKillerFn()}};j.noSuggestionsContainer=g('<div class="autocomplete-no-suggestion"></div>').html(this.options.noSuggestionNotice).get(0);j.suggestionsContainer=e.utils.createNode(b.containerClass);c=g(j.suggestionsContainer);c.appendTo(b.appendTo);if(b.width!=="auto"){c.width(b.width)}c.on("mouseover.autocomplete",d,function(){j.activate(g(this).data("index"))});c.on("mouseout.autocomplete",function(){j.selectedIndex=-1;c.children("."+a).removeClass(a)});c.on("click.autocomplete",d,function(){j.select(g(this).data("index"))});j.fixPositionCapture=function(){if(j.visible){j.fixPosition()}};g(window).on("resize.autocomplete",j.fixPositionCapture);j.el.on("keydown.autocomplete",function(i){j.onKeyPress(i)});j.el.on("keyup.autocomplete",function(i){j.onKeyUp(i)});j.el.on("blur.autocomplete",function(){j.onBlur()});j.el.on("focus.autocomplete",function(){j.onFocus()});j.el.on("change.autocomplete",function(i){j.onKeyUp(i)});j.el.on("input.autocomplete",function(i){j.onKeyUp(i)})},onFocus:function(){var a=this;a.fixPosition();if(a.options.minChars===0&&a.el.val().length===0){a.onValueChange()}},onBlur:function(){this.enableKillerFn()},abortAjax:function(){var a=this;if(a.currentRequest){a.currentRequest.abort();a.currentRequest=null}},setOptions:function(c){var a=this,b=a.options;g.extend(b,c);a.isLocal=g.isArray(b.lookup);if(a.isLocal){b.lookup=a.verifySuggestionsFormat(b.lookup)}b.orientation=a.validateOrientation(b.orientation,"bottom");g(a.suggestionsContainer).css({"max-height":b.maxHeight+"px",width:b.width+"px","z-index":b.zIndex})},clearCache:function(){this.cachedResponse={};this.badQueries=[]},clear:function(){this.clearCache();this.currentValue="";this.suggestions=[]},disable:function(){var a=this;a.disabled=true;clearInterval(a.onChangeInterval);a.abortAjax()},enable:function(){this.disabled=false},fixPosition:function(){var z=this,x=g(z.suggestionsContainer),v=x.parent().get(0);if(v!==document.body&&!z.options.forceFixPosition){return}var A=z.options.orientation,c=x.outerHeight(),d=z.el.outerHeight(),b=z.el.offset(),t={top:b.top,left:b.left};if(A==="auto"){var u=g(window).height(),w=g(window).scrollTop(),y=-w+b.top-c,s=w+u-(b.top+d+c);A=(Math.max(y,s)===y)?"top":"bottom"}if(A==="top"){t.top+=-c}else{t.top+=d}if(v!==document.body){var a=x.css("opacity"),B;if(!z.visible){x.css("opacity",0).show()}B=x.offsetParent().offset();t.top-=B.top;t.left-=B.left;if(!z.visible){x.css("opacity",a).hide()}}if(z.options.width==="auto"){t.width=(z.el.outerWidth()-2)+"px"}x.css(t)},enableKillerFn:function(){var a=this;g(document).on("click.autocomplete",a.killerFn)},disableKillerFn:function(){var a=this;g(document).off("click.autocomplete",a.killerFn)},killSuggestions:function(){var a=this;a.stopKillSuggestions();a.intervalId=window.setInterval(function(){a.hide();a.stopKillSuggestions()},50)},stopKillSuggestions:function(){window.clearInterval(this.intervalId)},isCursorAtEnd:function(){var b=this,c=b.el.val().length,a=b.element.selectionStart,d;if(typeof a==="number"){return a===c}if(document.selection){d=document.selection.createRange();d.moveStart("character",-c);return c===d.text.length}return true},onKeyPress:function(a){var b=this;if(!b.disabled&&!b.visible&&a.which===h.DOWN&&b.currentValue){b.suggest();return}if(b.disabled||!b.visible){return}switch(a.which){case h.ESC:b.el.val(b.currentValue);b.hide();break;case h.RIGHT:if(b.hint&&b.options.onHint&&b.isCursorAtEnd()){b.selectHint();break}return;case h.TAB:if(b.hint&&b.options.onHint){b.selectHint();return}if(b.selectedIndex===-1){b.hide();return}b.select(b.selectedIndex);if(b.options.tabDisabled===false){return}break;case h.RETURN:if(b.selectedIndex===-1){b.hide();return}b.select(b.selectedIndex);break;case h.UP:b.moveUp();break;case h.DOWN:b.moveDown();break;default:return}a.stopImmediatePropagation();a.preventDefault()},onKeyUp:function(a){var b=this;if(b.disabled){return}switch(a.which){case h.UP:case h.DOWN:return}clearInterval(b.onChangeInterval);if(b.currentValue!==b.el.val()){b.findBestHint();if(b.options.deferRequestBy>0){b.onChangeInterval=setInterval(function(){b.onValueChange()},b.options.deferRequestBy)}else{b.onValueChange()}}},onValueChange:function(){var c=this,d=c.options,a=c.el.val(),b=c.getQuery(a);if(c.selection&&c.currentValue!==b){c.selection=null;(d.onInvalidateSelection||g.noop).call(c.element)}clearInterval(c.onChangeInterval);c.currentValue=a;c.selectedIndex=-1;if(d.triggerSelectOnValidInput&&c.isExactMatch(b)){c.select(0);return}if(b.length<d.minChars){c.hide()}else{c.getSuggestions(b)}},isExactMatch:function(a){var b=this.suggestions;return(b.length===1&&b[0].value.toLowerCase()===a.toLowerCase())},getQuery:function(a){var b=this.options.delimiter,c;if(!b){return a}c=a.split(b);return g.trim(c[c.length-1])},getSuggestionsLocal:function(c){var d=this,a=d.options,m=c.toLowerCase(),l=a.lookupFilter,n=parseInt(a.lookupLimit,10),b;b={suggestions:g.grep(a.lookup,function(i){return l(i,c,m)})};if(n&&b.suggestions.length>n){b.suggestions=b.suggestions.slice(0,n)}return b},getSuggestions:function(a){var n,o=this,c=o.options,b=c.serviceUrl,p,d,m;c.params[c.paramName]=a;p=c.ignoreParams?null:c.params;if(c.onSearchStart.call(o.element,c.params)===false){return}if(g.isFunction(c.lookup)){c.lookup(a,function(i){o.suggestions=i.suggestions;o.suggest();c.onSearchComplete.call(o.element,a,i.suggestions)});return}if(o.isLocal){n=o.getSuggestionsLocal(a)}else{if(g.isFunction(b)){b=b.call(o.element,a)}d=b+"?"+g.param(p||{});n=o.cachedResponse[d]}if(n&&g.isArray(n.suggestions)){o.suggestions=n.suggestions;o.suggest();c.onSearchComplete.call(o.element,a,n.suggestions)}else{if(!o.isBadQuery(a)){o.abortAjax();m={url:b,data:p,type:c.type,dataType:c.dataType};g.extend(m,c.ajaxSettings);o.currentRequest=g.ajax(m).done(function(j){var i;o.currentRequest=null;i=c.transformResult(j,a);o.processResponse(i,a,d);c.onSearchComplete.call(o.element,a,i.suggestions)}).fail(function(k,i,j){c.onSearchError.call(o.element,a,k,i,j)})}else{c.onSearchComplete.call(o.element,a,[])}}},isBadQuery:function(a){if(!this.options.preventBadQueries){return false}var c=this.badQueries,b=c.length;while(b--){if(a.indexOf(c[b])===0){return true}}return false},hide:function(){var a=this,b=g(a.suggestionsContainer);if(g.isFunction(a.options.onHide)&&a.visible){a.options.onHide.call(a.element,b)}a.visible=false;a.selectedIndex=-1;clearInterval(a.onChangeInterval);g(a.suggestionsContainer).hide();a.signalHint(null)},suggest:function(){if(this.suggestions.length===0){if(this.options.showNoSuggestionNotice){this.noSuggestions()}else{this.hide()}return}var t=this,c=t.options,s=c.groupBy,w=c.formatResult,b=t.getQuery(t.currentValue),z=t.classes.suggestion,a=t.classes.selected,r=g(t.suggestionsContainer),u=g(t.noSuggestionsContainer),x=c.beforeRender,v="",d,y=function(j,i){var k=j.data[s];if(d===k){return""}d=k;return'<div class="autocomplete-group"><strong>'+d+"</strong></div>"};if(c.triggerSelectOnValidInput&&t.isExactMatch(b)){t.select(0);return}g.each(t.suggestions,function(i,j){if(s){v+=y(j,b,i)}v+='<div class="'+z+'" data-index="'+i+'">'+w(j,b)+"</div>"});this.adjustContainerWidth();u.detach();r.html(v);if(g.isFunction(x)){x.call(t.element,r)}t.fixPosition();r.show();if(c.autoSelectFirst){t.selectedIndex=0;r.scrollTop(0);r.children("."+z).first().addClass(a)}t.visible=true;t.findBestHint()},noSuggestions:function(){var c=this,b=g(c.suggestionsContainer),a=g(c.noSuggestionsContainer);this.adjustContainerWidth();a.detach();b.empty();b.append(a);c.fixPosition();b.show();c.visible=true},adjustContainerWidth:function(){var a=this,c=a.options,b,d=g(a.suggestionsContainer);if(c.width==="auto"){b=a.el.outerWidth()-2;d.width(b>0?b:300)}},findBestHint:function(){var a=this,c=a.el.val().toLowerCase(),b=null;if(!c){return}g.each(a.suggestions,function(i,l){var d=l.value.toLowerCase().indexOf(c)===0;if(d){b=l}return !d});a.signalHint(b)},signalHint:function(a){var b="",c=this;if(a){b=c.currentValue+a.value.substr(c.currentValue.length)}if(c.hintValue!==b){c.hintValue=b;c.hint=a;(this.options.onHint||g.noop)(b)}},verifySuggestionsFormat:function(a){if(a.length&&typeof a[0]==="string"){return g.map(a,function(b){return{value:b,data:null}})}return a},validateOrientation:function(b,a){b=g.trim(b||"").toLowerCase();if(g.inArray(b,["auto","bottom","top"])===-1){b=a}return b},processResponse:function(c,b,d){var j=this,a=j.options;c.suggestions=j.verifySuggestionsFormat(c.suggestions);if(!a.noCache){j.cachedResponse[d]=c;if(a.preventBadQueries&&c.suggestions.length===0){j.badQueries.push(b)}}if(b!==j.getQuery(j.currentValue)){return}j.suggestions=c.suggestions;j.suggest()},activate:function(l){var d=this,b,k=d.classes.selected,c=g(d.suggestionsContainer),a=c.find("."+d.classes.suggestion);c.find("."+k).removeClass(k);d.selectedIndex=l;if(d.selectedIndex!==-1&&a.length>d.selectedIndex){b=a.get(d.selectedIndex);g(b).addClass(k);return b}return null},selectHint:function(){var a=this,b=g.inArray(a.hint,a.suggestions);a.select(b)},select:function(b){var a=this;a.hide();a.onSelect(b)},moveUp:function(){var a=this;if(a.selectedIndex===-1){return}if(a.selectedIndex===0){g(a.suggestionsContainer).children().first().removeClass(a.classes.selected);a.selectedIndex=-1;a.el.val(a.currentValue);a.findBestHint();return}a.adjustScroll(a.selectedIndex-1)},moveDown:function(){var a=this;if(a.selectedIndex===(a.suggestions.length-1)){return}a.adjustScroll(a.selectedIndex+1)},adjustScroll:function(d){var c=this,a=c.activate(d);if(!a){return}var m,n,l,b=g(a).outerHeight();m=a.offsetTop;n=g(c.suggestionsContainer).scrollTop();l=n+c.options.maxHeight-b;if(m<n){g(c.suggestionsContainer).scrollTop(m)}else{if(m>l){g(c.suggestionsContainer).scrollTop(m-c.options.maxHeight+b)}}if(!c.options.preserveInput){c.el.val(c.getValue(c.suggestions[d].value))}c.signalHint(null)},onSelect:function(c){var a=this,b=a.options.onSelect,d=a.suggestions[c];a.currentValue=a.getValue(d.value);if(a.currentValue!==a.el.val()&&!a.options.preserveInput){a.el.val(a.currentValue)}a.signalHint(null);a.suggestions=[];a.selection=d;if(g.isFunction(b)){b.call(a.element,d)}},getValue:function(j){var a=this,c=a.options.delimiter,b,d;if(!c){return j}b=a.currentValue;d=b.split(c);if(d.length===1){return j}return b.substr(0,b.length-d[d.length-1].length)+j},dispose:function(){var a=this;a.el.off(".autocomplete").removeData("autocomplete");a.disableKillerFn();g(window).off("resize.autocomplete",a.fixPositionCapture);g(a.suggestionsContainer).remove()}};g.fn.autocomplete=g.fn.devbridgeAutocomplete=function(a,b){var c="autocomplete";if(arguments.length===0){return this.first().data(c)}return this.each(function(){var d=g(this),j=d.data(c);if(typeof a==="string"){if(j&&typeof j[a]==="function"){j[a](b)}}else{if(j&&j.dispose){j.dispose()}j=new e(this,a);d.data(c,j)}})}}));